
\documentclass[11pt]{article}

%% WRY has commented out some unused packages %%
%% If needed, activate these by uncommenting
\usepackage{geometry}                % See geometry.pdf to learn the layout options. There are lots.
%\geometry{letterpaper}                   % ... or a4paper or a5paper or ... 
\geometry{a4paper,left=2.5cm,right=2.5cm,top=2.5cm,bottom=2.5cm}
%\geometry{landscape}                % Activate for rotated page geometry
%\usepackage[parfill]{parskip}    % Activate to begin paragraphs with an empty line rather than an indent

%for figures
%\usepackage{graphicx}

\usepackage{color}
\definecolor{mygreen}{RGB}{28,172,0} % color values Red, Green, Blue
\definecolor{mylilas}{RGB}{170,55,241}
%% for graphics this one is also OK:
\usepackage{epsfig}

%% AMS mathsymbols are enabled with
\usepackage{amssymb,amsmath}

%% more options in enumerate
\usepackage{enumerate}
\usepackage{enumitem}

%% insert code
\usepackage{listings}

\usepackage[utf8]{inputenc}

\usepackage{hyperref}

%% colors
\usepackage{graphicx,xcolor,lipsum}


\usepackage{mathtools}

\usepackage{graphicx}
\newcommand*{\matminus}{%
  \leavevmode
  \hphantom{0}%
  \llap{%
    \settowidth{\dimen0 }{$0$}%
    \resizebox{1.1\dimen0 }{\height}{$-$}%
  }%
}

\title{Notes on computational fluid dynamics}
\author{Cesar B Rocha}
\date{\today}

\begin{document}

\include{mysymbols}

\maketitle

This are notes I've been writing for my self study as part of the class ``Computational Fluid Dynamics'' (MAE 290C), taught by Prof. Juan C. del Alamo in Winter 2015. I'm also including material beyond the class syllabus.


I claim no originality to the content of these notes.  In particular, I'm loosely following del Alamo's class notes, and the following books

\begin{itemize}

    \item \textit{Spectral methods in fluid dynamics} by Canuto et al.;

    \item \textit{Computational techniques in fluid dynamics} by Fletcher et al.;

    \item \textit{Numerical Renaissance} by Bewley.

\end{itemize}

\section{Introduction}
We will study methods for solving  the Navier-Stokes (NS) equations

\beq
\label{eq:ns}
\p_t \vec{u} + \vec{u}\cdot \nabla \vec{u} = -\frac{\nabla p}{\rho} + \nu \lap \vec{u}\com
\eeq
where the laplacian is
\beq
\label{eq:lap_defn}
\lap \defn \nabla \cdot \nabla
\eeq
The momentum equation \eqref{eq:ns} is complemented by the conservation of mass
\beq
\label{eq:cons_mass}
\nabla\cdot\vec{u} = 0\per
\eeq
To close the system, we will also need a thermodynamic equation, which we will introduce later.

The advective term $\vec{u}\cdot\nabla\vec{u}$ gives a hyperbolic flavor to the NS equations. Its quadratic non-linearity typically prohibits analytic solutions. It gives rise to fascinating phenomena like turbulence. In contrast the linear viscous term $\nu\lap\vec{u}$ gives a parabolic flavour the NS equations.

\section{Temporal discretizations of the NS equations}
We consider a one-dimensional linear version of \eqref{eq:ns}, and drop the pressure gradient term for simplicity,
\beq
\label{eq:oned_ns}
\p_t u + c \,\p_x u = \nu \p_{xx}^2 u\com
\eeq
where $c$ is a constant speed. Fourier transforming in the $x$-direction we obtain
\beq
\label{eq:oned_ns_h}
\p_t\hat{u} =\underbrace{ (-\ii c\,k + \nu k^2)}_{\defn \lambda} \hat{u}\com
\eeq
where $k$ is the wavenumber. \eqref{eq:oned_ns} is an eigenproblem with eigenvalue $\lambda$. Decaying solutions have $\Re\left(\lambda\right) < 0$, and numerical schemes must represent this behavior. Figure \ref{fig:eigs_nu} shows the eigenvalue as a function of $\nu$. A $\nu$ increases the real part of the eigenvalue becomes more negative, whereas for very small $\nu$ the eigenvalue are almost purely imaginary. This example illustrates one of the challenges for time marching numerical schemes. These schemes should have stability regions that comprise large negative real number and the imaginary axis. 

\begin{figure}[ht]
\begin{center}
\includegraphics[width=19pc,angle=0]{figs/eigs_linear_1d_ns.eps}
\end{center}
\caption{The eigenvalue $\lambda$ as function of the parameter $\nu$ with fixed speed $c = .5$.}
\label{fig:eigs_nu}
\end{figure}

One may be tempted to use implicit methods since they are unconditionally stable. However, from an implementation point of view, the implicit methods applied to the non-linear terms in \eqref{eq:ns} would lead to non-linear algebraic equations to be solved every time step, which can be very computationally costly. 

For the advective terms we typically use two main schemes:

\begin{itemize}
\item Multi-step (e.g. Adams-Bashfort methods);
    \item Single-step, multiple sub-steps (e.g. Runge-Kutta methods).
\end{itemize}
Adams-Bashforth (AB) methods are more memory demanding, whereas Runge-Kutta (RK) schemes require more flops. The most efficient method depends on computer architecture. In recent computers memory, not CPU, is the main limitations, so we may use RK methods.


\subsection{Runge-Kutta methods}
Runge-Kutta (RK) are explicit, single-step, multi-sub-steps, schemes. The general form of an RK scheme for a non-linear equation 
\beq
\label{eq:gov_eqn}
\p_t u = F(u,t)\com
\eeq
is
\beq
\label{eq:rk_general}
u^{n+1} = u^n + \dt \left(b_1 k_1 + \ldots + b_M k_M\right)
\eeq

\begin{align}
    \label{eq:rk_ks}
    k_1 &= F(u^n,t^n)\com \nonumber \\
k_2 &= F(u^n+a_{21}k_1\dt,t^n + c_2 \dt)\com \nonumber \\
    &\vdots \nonumber \\
    k_{M} &= F(u^n+a_{21}k_1\dt + \ldots + a_{M,M-1}k_{M-1}\dt,t^n , c_2 \dt + \ldots + c_M\dt)\per
\end{align}


To systematically keep track of the coefficients, we introduce the Butcher table
\begin{table}
\label{butcher_table}
\caption{The Butcher table.}
\centering
\begin{tabular}{l| c c c c c c c }
    c$_2$ & a$_{2,1}$ & 0 & \ldots & & 0 \\
    c$_3$ & a$_{3,1}$ & a$_{3,2}$ & 0 & \ldots & $\vdots$ \\
    $\vdots$ & $\vdots$ & $\ddots$ & $\ddots$  \\
    c$_M$ & a$_{M,1}$ & a$_{M,2}$ & &\ldots &a$_{M,M-1}$\\
\hline
\end{tabular}
\end{table}

\subsubsection{RK2, the simplest example}
With M=2 we have
\beq
\label{eq:rk2}
u^{n+1} = u^n + \dt \left(b_1 k_1 + b_2k_2\right)\com
\eeq
with
\begin{align}
k_1 &= F(u^n,t^n ) \com \nonumber \\
k_2 &= F(u^n + a_{2,1} k_1 \dt, t^n +c_2 \dt )\per
\end{align}
There are four parameters $a_{2,1}$, $b_1$, $b_2$, and $c_2$. We choose these parameters to maximize the order of accuracy of the scheme. We expand $k_2$ about $k_1$
\beq
\label{eq:k2_about_k1}
k_2 = k_1 + a_{21} k_1 \dt \,\p_u F (u^n,t^n) + c_2 \dt \p_t \, F + \ord(\dt^2)\per
\eeq
Thus
\beq
\label{eq:un_rk2}
u^{n+1} = u^n + \dt\left[(b_1 + b_2) F(u^n,t^n) + b_2 a_{2,1} \dt\, \p_u F(u^n,t^n) + b_2 c_2 \dt\, \p_t F(u^n,t^n) \right]
\eeq
The Taylor expansion of $u^{n+1}$ about $u^n$ is
\begin{align}
\label{eq:un_taylor}
u^{n+1} = u^n + \dt& \p_t u |^n + \frac{\dt^2}{2} \p_{tt}^n u | ^n + \ord(\dt^3) =\nonumber\\ & u^n + \dt \p_t u |^n +\p_t F(u^n,t^n)+\p_u F(u^n,t^n)F(u^n,t^n) + \ord(\dt^3)  \com
\end{align}
where the equality follows from the governing equation \eqref{eq:gov_eqn}. Matching terms in \eqref{eq:un_taylor} and \eqref{eq:un_rk2} gives
\beq
\label{eq:sys_rk2}
\begin{cases}
b_1 + b_2 = 1; \\
b_2 c_2 = \frac{1}{2};\\
b_2 a_{2,1} = \frac{1}{2}.\\
\end{cases} 
\eeq
The system \eqref{eq:sys_rk2} is underdetermined: there are 4 unknowns but only 3 equations. Choosing $c_2 \equiv c$ as a free parameter, we obtain
\beq
\label{eq:param_rk2}
a_1 = c\com \qquad b_2 = \frac{1}{2c}\com \qqand b_1 = 1 - \frac{1}{2c}\per
\eeq
The parameter $c$ can be chosen to give the best accuracy. Typically $\tfrac{1}{2}\leq c\leq 1$. The linear stability is independent of $c$. For the linear problem $F = \lambda u$. Thus
\beq
\label{eq:stab_rk2}
u^{n+1} = u^n \left(1 + \lambda\dt + \frac{(\lambda\dt)^2}{2}\right)\per
\eeq
Stability requires
\beq
\label{eq:stab_constraint_rk2}
\sigma = \left|1 + \lambda\dt + \frac{(\lambda\dt)^2}{2} \right| \leq 1\per
\eeq

\begin{figure}[ht]
\begin{center}
\includegraphics[width=12pc,angle=0]{figs/stability_region_rk2.png}
\includegraphics[width=12pc,angle=0]{figs/stability_region_rk3.png}
\includegraphics[width=12pc,angle=0]{figs/stability_region_rk4.png}
\end{center}
\caption{Stability region for Runge-Kutta schemes.}
\label{fig:eigs_nu}
\end{figure}



\end{document}


